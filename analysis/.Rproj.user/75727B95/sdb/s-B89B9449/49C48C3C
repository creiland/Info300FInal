{
    "collab_server" : "",
    "contents" : "require(dplyr)\nrequire(ggplot2)\n\nload(\"mydata\")\n\n#correlation matrix\ncor_data <- na.omit(new_data)\ncor_data <- select(cor_data, -c('athlete.sex'))\n\n#correlation matrix for clean data\ncor_matrix <- cor(cor_data, use = \"pairwise.complete.obs\")\ncorrplot(cor_matrix, type = \"upper\", order = \"hclust\", \n         tl.col = \"black\", tl.srt = 45)\n\n#male watts\nmale_watts <- select(new_data, scode, average_watts) %>% filter(scode==2)\nmale_watts <- na.omit(male_watts)\n\n\nm_watts_plot <- ggplot(male_watts, xlab=\"Average Watts During Workout\", ylab='Density', \n                       main='Distribution of Male Average Watts per Workout', aes(x=average_watts)) + \n  geom_density() +\n  geom_vline(aes(xintercept = mean(male_watts$average_watts), color = 'Mean'), linetype=\"dashed\") +\n  geom_vline(aes(xintercept = median(male_watts$average_watts), color = 'Median'), linetype=\"dashed\") +\n  scale_color_manual(name = \"Legend\", values = c(Mean = \"red\", Median = \"blue\"))\nm_watts_plot\n\n#female watts\nfemale_watts <- select(new_data, scode, average_watts) %>% filter(scode==1)\nfemale_watts <- na.omit(female_watts)\n\nf_watts_plot <- ggplot(female_watts, xlab=\"Average Watts During Workout\", ylab='Density', \n                       main='Distribution of Female Average Watts per Workout', aes(x=average_watts)) + \n  geom_density() +\n  geom_vline(aes(xintercept = mean(female_watts$average_watts), color = 'Mean'), linetype=\"dashed\") +\n  geom_vline(aes(xintercept = median(female_watts$average_watts), color = 'Median'), linetype=\"dashed\") +\n  scale_color_manual(name = \"Legend\", values = c(Mean = \"red\", Median = \"blue\"))\nf_watts_plot\n\n#box plots for wattage by sex\nwatt_data <- na.omit(select(new_data, athlete.sex, average_watts)) %>% filter(average_watts > 0)\nwatt_box <- ggplot(watt_data, aes(x=athlete.sex, y=average_watts)) + ggtitle(\"Average Watts by Sex\") +\n  geom_boxplot(notch = T)\nwatt_box\n\n#####################t test for gender wattages\n#male\nqq_male <- qqnorm(male_watts$average_watts, main=\"Normal QQ Plot for Male Average Watts\")\nabline(mean(male_watts$average_watts), sd(male_watts$average_watts))\n\n#female\nqq_female <- qqnorm(female_watts$average_watts, main=\"Normal QQ Plot for Female Average Watts\")\nabline(mean(female_watts$average_watts), sd(female_watts$average_watts))\n\n#f test\nvar.test(male_watts, female_watts)\n\n#two sample t test\nt.test(male_watts,female_watts, var.equal=TRUE, paired=FALSE)\n\n\n###################t test for gender heartrate\n###remove na and 0 to normalize a little\nheartrate <- na.omit(select(new_data, athlete.sex, average_heartrate)) %>% filter(average_heartrate != 0) %>% group_by(athlete.sex) %>% \n  summarise(avg_heartrate = mean(average_heartrate, na.rm=T))\n\nheartrate_median <- na.omit(select(new_data, athlete.sex, average_heartrate)) %>% filter(average_heartrate != 0) %>% group_by(athlete.sex) %>% \n  summarise(avg_heartrate = median(average_heartrate, na.rm=T))\n\n#male (remove zeros to help normalize)\nmale_hr <- select(new_data, athlete.sex, average_heartrate) %>% filter(athlete.sex=='M')\nqq_male_hr <- qqnorm(male_hr$average_heartrate, main='Normal QQ Plot for Male Heart Rate')\nabline(mean(male_hr$average_heartrate, na.rm=T), sd(male_hr$average_heartrate, na.rm=T))\n\n#female (remove 0s to help normalize)\nfemale_hr <- select(new_data, athlete.sex, average_heartrate) %>% filter(athlete.sex=='F')\nqq_female_hr <- qqnorm(female_hr$average_heartrate, main='Normal QQ Plot for Female Heart Rate')\nabline(mean(female_hr$average_heartrate, na.rm=T), sd(female_hr$average_heartrate, na.rm=T))\n\n#box plots for heartrate by sex\nhr_box <- ggplot(new_data, aes(x=athlete.sex, y=average_heartrate)) + ggtitle(\"Average Heart Rate by Sex\") +\n  geom_boxplot(notch = T)\nhr_box\n\n#distribution for male heart rate\nm_hr_plot <- ggplot(male_hr, xlab=\"Average Heartrate During Workout\", ylab='Density', \n                    main='Distribution of Male Average Heartrate per Workout', aes(x=average_heartrate)) + \n  geom_density() +\n  geom_vline(aes(xintercept = mean(male_hr$average_heartrate), color = 'Mean'), linetype=\"dashed\") +\n  geom_vline(aes(xintercept = median(male_hr$average_heartrate), color = 'Median'), linetype=\"dashed\") +\n  scale_color_manual(name = \"Legend\", values = c(Mean = \"red\", Median = \"blue\"))\nm_hr_plot\n\n#distribution for female heart rate\nf_hr_plot <- ggplot(female_hr, xlab=\"Average Heartrate During Workout\", ylab='Density', \n                    main='Distribution of Female Average Heartrate per Workout', aes(x=average_heartrate)) + \n  geom_density() +\n  geom_vline(aes(xintercept = mean(female_hr$average_heartrate), color = 'Mean'), linetype=\"dashed\") +\n  geom_vline(aes(xintercept = median(female_hr$average_heartrate), color = 'Median'), linetype=\"dashed\") +\n  scale_color_manual(name = \"Legend\", values = c(Mean = \"red\", Median = \"blue\"))\nf_hr_plot\n\n#remove outliers\nmale_hr <- male_hr %>% filter(average_heartrate > mean(male_hr$average_heartrate, na.rm=T) - 1.5 * IQR(male_hr$average_heartrate, na.rm=T)) %>% \n          filter(average_heartrate < mean(male_hr$average_heartrate, na.rm=T) + 1.5 * IQR(male_hr$average_heartrate, na.rm=T))\nfemale_hr <- female_hr %>% filter(average_heartrate > mean(female_hr$average_heartrate, na.rm=T) - 1.5 * IQR(female_hr$average_heartrate, na.rm=T)) %>% \n  filter(average_heartrate < mean(female_hr$average_heartrate, na.rm=T) + 1.5 * IQR(female_hr$average_heartrate, na.rm=T))\n\n#t test for difference in male and female heartrate\nt.test(male_hr$average_heartrate, female_hr$average_heartrate, var.equal=TRUE, paired=FALSE)\n\n#f test\nvar.test(male_hr$average_heartrate, female_hr$average_heartrate)\n\n#standard deviation for watts and heart rate\nsd_watts <- sd(new_data$average_watts, na.rm=T)\nsd_heartrate <- sd(new_data$average_heartrate, na.rm=T)\n\n\n#kudos\nk <- select(new_data, kudos_count, average_watts)\nk_qq <- qqnorm(k$kudos_count, main='Normal QQ Plot for Kudos Count')\nabline(mean(k$kudos_count, na.rm=T), sd(k$kudos_count, na.rm=T))\n\n#qq for nozero kudos\nk_nozero <- filter(k, kudos_count > 0)\nk_qq_nozero <- qqnorm(k_nozero$kudos_count, main='Normal QQ Plot for Kudos Count (zeros removed)')\nabline(mean(k_nozero$kudos_count, na.rm=T), sd(k_nozero$kudos_count, na.rm=T))\n\n\n#remove outliers\nk_norm <- k_nozero %>% filter(kudos_count > mean(k_nozero$kudos_count, na.rm=T) - 1.5 * IQR(k_nozero$kudos_count, na.rm=T)) %>% \n  filter(kudos_count < mean(k_nozero$kudos_count, na.rm=T) + 1.5 * IQR(k_nozero$kudos_count, na.rm=T))\nk_norm <- k_norm %>% filter(average_watts > mean(k_norm$average_watts, na.rm=T) - 1.5 * IQR(k_norm$average_watts, na.rm=T)) %>% \n  filter(kudos_count < mean(k_norm$average_watts, na.rm=T) + 1.5 * IQR(k_norm$average_watts, na.rm=T))\n\n\n\n#Poisson regression\nfit=glm(kudos_count ~ average_watts, data=k_norm, family=poisson(link=log))\nsummary(fit)\n\n## calculate and store predicted values\nk_norm$predicted <- predict(fit, type=\"response\")\n\n## create the plot\nkp <- ggplot(k_norm, aes(x = average_watts, y = predicted)) +\n  geom_point(aes(y = kudos_count), alpha=.5, position=position_jitter(h=.2)) +\n  geom_line(size = 1) +\n  labs(x = \"Average Watts\", y = \"Predicted Kudos Count\")\n",
    "created" : 1544583728355.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3901490940",
    "id" : "49C48C3C",
    "lastKnownWriteTime" : 1543477425,
    "last_content_update" : 1543477425,
    "path" : "C:/Users/creil/Desktop/Info370/Assignment3/modeling.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}